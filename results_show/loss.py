import matplotlib.pyplot as plt

# 数据
steps = [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000,
         2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000]
total_loss = [1.0029, 1.0077, 1.0010, 1.0181, 0.9881, 1.0031, 1.0105, 1.0126, 0.9605, 1.0021, 0.9661, 0.8960, 1.0955, 0.9706, 1.0942, 1.0246, 0.8775,
              0.9537, 0.7986, 0.7872, 0.7793, 0.7707, 0.9434, 0.9687, 0.8903, 0.8366, 1.2107, 0.9325, 0.6879, 0.8123, 1.0096, 0.8743, 1.0673, 0.9853,
              0.6978, 1.0343, 0.7664, 1.0997, 1.0027, 0.9011]
kl_loss = [0.1656, 0.1706, 0.0037, 0.3507, 0.0002, 0.3090, 0.1735, 0.4205, 0.0001, 0.3420, 0.3165, 0.1771, 0.4090, 0.1263, 0.4339, 0.3377, 0.2236,
           0.1738, 0.1266, 0.1315, 0.1117, 0.1063, 0.1744, 0.1380, 0.0140, 0.0162, 0.1847, 0.3207, 0.0983, 0.2287, 0.2622, 0.0005, 0.2516, 0.3250,
           0.1038, 0.1542, 0.2109, 0.3192, 0.2296, 0.0226]
cls_loss = [1.0959, 1.1007, 1.1119, 1.0922, 1.0979, 1.0802, 1.1035, 1.0784, 1.0672, 1.0754, 1.0382, 0.9759, 1.1718, 1.0644, 1.1676, 1.1010, 0.9501,
            1.0404, 0.8733, 0.8601, 0.8535, 0.8445, 1.0289, 1.0610, 0.9876, 0.9278, 1.3247, 1.0004, 0.7534, 0.8771, 1.0926, 0.9714, 1.1579, 1.0587,
            0.7638, 1.1321, 0.8281, 1.1864, 1.0886, 0.9987]

# 绘制损失曲线
plt.figure(figsize=(10, 6))
plt.plot(steps, total_loss, label='Total Loss')
plt.plot(steps, kl_loss, label='KL Loss')
plt.plot(steps, cls_loss, label='CLS Loss')
plt.xlabel('Global Step')
plt.ylabel('Loss')
plt.title('Training Loss Curve')
plt.legend()
plt.grid(True)
plt.show()
